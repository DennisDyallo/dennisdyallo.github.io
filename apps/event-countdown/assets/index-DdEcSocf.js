(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();class S{DEFAULT_HOLIDAY_CALENDAR="usa";constructor(e){this.holidayService=e,this.onUpdate=()=>{},this.onExpiry=()=>{},this.loadState()}loadState(){try{const e=localStorage.getItem("countdownState");e?this.applyLoadedState(JSON.parse(e)):this.initializeDefaultState()}catch(e){console.error("Failed to load state from localStorage",e),this.initializeDefaultState()}this.expired=!1,this.holidayService.init(this.holidayCalendar)}applyLoadedState(e){this.targetDate=e.targetDate?new Date(e.targetDate):null,this.holidayCalendar=e.holidayCalendar||this.DEFAULT_HOLIDAY_CALENDAR,this.excludeWeekends=e.excludeWeekends!==!1,this.excludeHolidays=e.excludeHolidays!==!1,this.customExclusions=e.customExclusions||[],this.exclusionIdCounter=this.customExclusions.length>0?Math.max(...this.customExclusions.map(t=>t.id))+1:0}initializeDefaultState(){this.targetDate=null,this.interval=null,this.excludeWeekends=!0,this.excludeHolidays=!0,this.holidayCalendar=this.DEFAULT_HOLIDAY_CALENDAR,this.customExclusions=[],this.exclusionIdCounter=0}saveState(){const e={targetDate:this.targetDate,holidayCalendar:this.holidayCalendar,excludeWeekends:this.excludeWeekends,excludeHolidays:this.excludeHolidays,customExclusions:this.customExclusions};localStorage.setItem("countdownState",JSON.stringify(e))}start(){this.interval&&clearInterval(this.interval),this.update(),this.interval=setInterval(()=>this.update(),1e3)}update(){if(!this.targetDate)return;const e=new Date,t=this.targetDate-e;if(t<=0){this.handleExpired();return}const n=this.calculateBusinessDays(e,this.targetDate),a=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),s=Math.floor(t%(1e3*60*60)/(1e3*60)),i=Math.floor(t%(1e3*60)/1e3);this.onUpdate({businessDays:n,hours:a,minutes:s,seconds:i,expired:!1})}handleExpired(){this.interval&&(clearInterval(this.interval),this.interval=null),this.expired||(this.expired=!0,this.onExpiry()),this.onUpdate({businessDays:0,hours:0,minutes:0,seconds:0,expired:!0})}setTargetDate(e){this.targetDate=e,this.expired=!1,this.saveState(),this.start()}setHolidayCalendar(e){this.holidayCalendar=e,this.holidayService.init(e),this.saveState(),this.update()}setExcludeWeekends(e){this.excludeWeekends=e,this.saveState(),this.update()}setExcludeHolidays(e){this.excludeHolidays=e,this.saveState(),this.update()}addCustomExclusion(e){this.customExclusions.push(e),this.saveState(),this.update()}removeCustomExclusion(e){this.customExclusions=this.customExclusions.filter(t=>t.id!==e),this.saveState(),this.update()}updateCustomExclusion(e){const t=this.customExclusions.findIndex(n=>n.id===e.id);t!==-1&&(this.customExclusions[t]={...this.customExclusions[t],...e}),this.saveState(),this.update()}getExcludedHolidays(e,t){const n=[],a=e.getFullYear(),s=t.getFullYear();for(let i=a;i<=s;i++){const r=this.holidayService.getHolidays(i).filter(y=>{const d=new Date(y.date);return d>e&&d<t});n.push(...r)}return n.sort((i,o)=>new Date(i.date)-new Date(o.date))}calculateBusinessDays(e,t){let n=0;const a=new Date(e);for(a.setDate(a.getDate()+1),a.setHours(0,0,0,0);a<t;)this.isBusinessDay(a)&&n++,a.setDate(a.getDate()+1);return n}isBusinessDay(e){if(this.excludeWeekends){const t=e.getDay();if(t===0||t===6)return!1}if(this.excludeHolidays){const t=this.holidayService.getHolidays(e.getFullYear()),n=e.toISOString().split("T")[0];if(t.some(a=>a.date.startsWith(n)))return!1}return!this.isDateInCustomExclusions(e)}isDateInCustomExclusions(e){const t=e.toISOString().split("T")[0];return this.customExclusions.some(n=>!n.startDate||!n.endDate?!1:t>=n.startDate&&t<=n.endDate)}}const D=[{code:"en",name:"English"},{code:"es",name:"Español"},{code:"fr",name:"Français"},{code:"de",name:"Deutsch"},{code:"sv",name:"Svenska"}],x=[{id:"usa",name:"USA"},{id:"de",name:"Germany"},{id:"se",name:"Sweden"}],v="/apps/event-countdown/audio/notification.mp3";class w{constructor(e,t,n){this.countdown=e,this.localizationService=t,this.notificationService=n,this.initializeElements(),this.populateLanguageSelector(),this.populateHolidayCalendarSelector(),this.bindEvents(),this.initializeState(),this.countdown.onUpdate=a=>this.updateDisplay(a),this.countdown.onExpiry=()=>this.handleExpiry(),this.localizationService.onLanguageChange=()=>this.updateAllText()}initializeElements(){this.elements={targetDate:document.getElementById("targetDate"),holidayCalendar:document.getElementById("holidayCalendar"),language:document.getElementById("language"),excludeWeekends:document.getElementById("excludeWeekends"),excludeHolidays:document.getElementById("excludeHolidays"),businessDays:document.getElementById("businessDays"),hours:document.getElementById("hours"),minutes:document.getElementById("minutes"),seconds:document.getElementById("seconds"),status:document.getElementById("status"),countdownSummary:document.getElementById("countdownSummary"),addExclusion:document.getElementById("addExclusion"),exclusionList:document.getElementById("exclusionList"),exclusionSummary:document.getElementById("exclusionSummary")},this.audio=new Audio(v)}populateLanguageSelector(){this.elements.language.innerHTML="",D.forEach(e=>{const t=document.createElement("option");t.value=e.code,t.textContent=e.name,this.elements.language.appendChild(t)})}populateHolidayCalendarSelector(){this.elements.holidayCalendar.innerHTML="",x.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,this.elements.holidayCalendar.appendChild(t)})}bindEvents(){this.elements.targetDate.addEventListener("change",()=>this.handleTargetDateChange()),this.elements.holidayCalendar.addEventListener("change",()=>this.handleHolidayCalendarChange()),this.elements.language.addEventListener("change",()=>this.handleLanguageChange()),this.elements.excludeWeekends.addEventListener("change",()=>this.handleSettingsChange()),this.elements.excludeHolidays.addEventListener("change",()=>this.handleSettingsChange()),this.elements.addExclusion.addEventListener("click",e=>{e.preventDefault(),this.addCustomExclusion()})}initializeState(){this.notificationService.isSupported()&&this.notificationService.getPermission()==="default"&&this.notificationService.requestPermission(),this.countdown.targetDate?(this.elements.targetDate.value=this.formatDateForInput(this.countdown.targetDate),this.countdown.start()):this.setDefaultDate(),this.elements.holidayCalendar.value=this.countdown.holidayCalendar,this.elements.language.value=this.localizationService.getCurrentLanguage(),this.elements.excludeWeekends.checked=this.countdown.excludeWeekends,this.elements.excludeHolidays.checked=this.countdown.excludeHolidays,this.countdown.customExclusions.forEach(e=>this.renderExclusionItem(e)),this.updateAllText()}setDefaultDate(){const e=new Date;e.setDate(e.getDate()+7),e.setHours(17,0,0,0),this.elements.targetDate.value=this.formatDateForInput(e),this.handleTargetDateChange()}handleTargetDateChange(){if(this.elements.targetDate.value){const e=new Date(this.elements.targetDate.value);this.countdown.setTargetDate(e),this.elements.targetDate.blur()}}handleHolidayCalendarChange(){this.countdown.setHolidayCalendar(this.elements.holidayCalendar.value)}handleLanguageChange(){this.localizationService.loadLanguage(this.elements.language.value)}handleSettingsChange(){this.countdown.setExcludeWeekends(this.elements.excludeWeekends.checked),this.countdown.setExcludeHolidays(this.elements.excludeHolidays.checked)}handleExpiry(){this.audio.play();const e=this.localizationService.translate("timesUp"),t=this.localizationService.translate("alertMessage");this.notificationService.showNotification(e,{body:t}),document.title=e}updateDisplay({businessDays:e,hours:t,minutes:n,seconds:a,expired:s}){this.elements.businessDays.textContent=e.toString(),this.elements.hours.textContent=t.toString().padStart(2,"0"),this.elements.minutes.textContent=n.toString().padStart(2,"0"),this.elements.seconds.textContent=a.toString().padStart(2,"0"),s?(this.elements.countdownSummary.textContent=this.localizationService.translate("timesUp"),this.elements.status.classList.add("expired")):(this.elements.status.classList.remove("expired"),this.updateCountdownSummary()),this.updateExclusionSummary()}updateAllText(){document.querySelector("h1").textContent=this.localizationService.translate("appTitle"),document.querySelector('label[for="targetDate"]').textContent=this.localizationService.translate("targetDateLabel"),document.querySelector('label[for="holidayCalendar"]').textContent=this.localizationService.translate("holidayCalendarLabel"),document.querySelector('label[for="language"]').textContent=this.localizationService.translate("languageLabel"),document.querySelector('label[for="excludeWeekends"]').textContent=this.localizationService.translate("excludeWeekendsLabel"),document.querySelector('label[for="excludeHolidays"]').textContent=this.localizationService.translate("excludeHolidaysLabel"),document.querySelector("#countdown .time-unit:nth-child(1) .time-label").textContent=this.localizationService.translate("businessDaysLabel"),document.querySelector("#countdown .time-unit:nth-child(2) .time-label").textContent=this.localizationService.translate("hoursLabel"),document.querySelector("#countdown .time-unit:nth-child(3) .time-label").textContent=this.localizationService.translate("minutesLabel"),document.querySelector("#countdown .time-unit:nth-child(4) .time-label").textContent=this.localizationService.translate("secondsLabel"),document.querySelector(".custom-exclusions h3").textContent=this.localizationService.translate("customExclusionsTitle"),document.querySelector("#addExclusion").textContent=this.localizationService.translate("addRangeButton"),this.updateCountdownSummary(),this.updateExclusionSummary()}updateCountdownSummary(){if(!this.countdown.targetDate||!this.elements.countdownSummary)return;const e=new Date,t=this.countdown.calculateBusinessDays(e,this.countdown.targetDate),n=Math.ceil((this.countdown.targetDate-e)/(1e3*60*60*24));let a=[this.localizationService.translate("countdownSummary",{businessDays:t,totalDays:n})];if(this.countdown.excludeHolidays){const s=this.countdown.getExcludedHolidays(e,this.countdown.targetDate);if(s.length>0){const i=s.map(o=>`${o.name} (${new Date(o.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})})`).join(", ");a.push(this.localizationService.translate("excludingHolidays",{holidayNames:i}))}}this.elements.countdownSummary.innerHTML=a.join("<br>")}addCustomExclusion(){const t={id:++this.countdown.exclusionIdCounter,startDate:"",endDate:"",description:""};this.countdown.addCustomExclusion(t),this.renderExclusionItem(t)}renderExclusionItem(e){const t=document.createElement("div");t.className="exclusion-item",t.dataset.exclusionId=e.id;const n=this.countdown.targetDate?this.formatDateForInput(this.countdown.targetDate).split("T")[0]:"";t.innerHTML=`
            <input type="date" placeholder="Start Date" data-field="startDate" value="${e.startDate}" data-id="${e.id}" max="${n}" required>
            <input type="date" placeholder="End Date" data-field="endDate" value="${e.endDate}" data-id="${e.id}" max="${n}" required>
            <input type="text" placeholder="Description (optional)" value="${e.description}" data-field="description" data-id="${e.id}" maxlength="50">
            <button class="remove-btn" data-id="${e.id}" title="Remove exclusion">✕</button>
        `,this.elements.exclusionList.appendChild(t),t.querySelector(".remove-btn").addEventListener("click",()=>{this.countdown.removeCustomExclusion(e.id),t.remove(),this.updateExclusionSummary()}),["startDate","endDate","description"].forEach(a=>{t.querySelector(`[data-field="${a}"]`).addEventListener("change",i=>{const o={id:e.id,[a]:i.target.value};if(a==="startDate"){const r=t.querySelector('[data-field="endDate"]');r.value=i.target.value,r.min=i.target.value,o.endDate=i.target.value}this.countdown.updateCustomExclusion(o)})})}updateExclusionSummary(){const e=this.countdown.customExclusions.filter(n=>n.startDate&&n.endDate);let t=this.localizationService.translate("noCustomExclusions");if(e.length>0){const n=e.reduce((a,s)=>{const i=new Date(s.startDate),o=new Date(s.endDate),r=Math.ceil((o-i)/(1e3*60*60*24))+1;return a+Math.max(0,r)},0);t=this.localizationService.translate("exclusionsActive",{count:e.length,totalDays:n})}this.elements.exclusionSummary.textContent=t}formatDateForInput(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${t}-${n}-${a}T${s}:${i}`}}class C{constructor(e="SE"){this.country=e,this.initHolidayData(),this.init(e)}initHolidayData(){this.holidayData={SE:{name:"Sweden",holidays:{2024:[{date:"2024-01-01",name:"New Year's Day"},{date:"2024-01-06",name:"Epiphany"},{date:"2024-03-29",name:"Good Friday"},{date:"2024-04-01",name:"Easter Monday"},{date:"2024-05-01",name:"Labour Day"},{date:"2024-05-09",name:"Ascension Day"},{date:"2024-06-06",name:"National Day"},{date:"2024-06-21",name:"Midsummer Eve"},{date:"2024-06-22",name:"Midsummer Day"},{date:"2024-11-02",name:"All Saints' Day"},{date:"2024-12-24",name:"Christmas Eve"},{date:"2024-12-25",name:"Christmas Day"},{date:"2024-12-26",name:"Boxing Day"},{date:"2024-12-31",name:"New Year's Eve"}],2025:[{date:"2025-01-01",name:"New Year's Day"},{date:"2025-01-06",name:"Epiphany"},{date:"2025-04-18",name:"Good Friday"},{date:"2025-04-21",name:"Easter Monday"},{date:"2025-05-01",name:"Labour Day"},{date:"2025-05-29",name:"Ascension Day"},{date:"2025-06-06",name:"National Day"},{date:"2025-06-20",name:"Midsummer Eve"},{date:"2025-06-21",name:"Midsummer Day"},{date:"2025-11-01",name:"All Saints' Day"},{date:"2025-12-24",name:"Christmas Eve"},{date:"2025-12-25",name:"Christmas Day"},{date:"2025-12-26",name:"Boxing Day"},{date:"2025-12-31",name:"New Year's Eve"}]}},US:{name:"United States",holidays:{2024:[{date:"2024-01-01",name:"New Year's Day"},{date:"2024-01-15",name:"Martin Luther King Jr. Day"},{date:"2024-02-19",name:"Presidents' Day"},{date:"2024-05-27",name:"Memorial Day"},{date:"2024-07-04",name:"Independence Day"},{date:"2024-09-02",name:"Labor Day"},{date:"2024-10-14",name:"Columbus Day"},{date:"2024-11-11",name:"Veterans Day"},{date:"2024-11-28",name:"Thanksgiving Day"},{date:"2024-12-25",name:"Christmas Day"}],2025:[{date:"2025-01-01",name:"New Year's Day"},{date:"2025-01-20",name:"Martin Luther King Jr. Day"},{date:"2025-02-17",name:"Presidents' Day"},{date:"2025-05-26",name:"Memorial Day"},{date:"2025-07-04",name:"Independence Day"},{date:"2025-09-01",name:"Labor Day"},{date:"2025-10-13",name:"Columbus Day"},{date:"2025-11-11",name:"Veterans Day"},{date:"2025-11-27",name:"Thanksgiving Day"},{date:"2025-12-25",name:"Christmas Day"}]}},GB:{name:"United Kingdom",holidays:{2024:[{date:"2024-01-01",name:"New Year's Day"},{date:"2024-03-29",name:"Good Friday"},{date:"2024-04-01",name:"Easter Monday"},{date:"2024-05-06",name:"Early May Bank Holiday"},{date:"2024-05-27",name:"Spring Bank Holiday"},{date:"2024-08-26",name:"Summer Bank Holiday"},{date:"2024-12-25",name:"Christmas Day"},{date:"2024-12-26",name:"Boxing Day"}],2025:[{date:"2025-01-01",name:"New Year's Day"},{date:"2025-04-18",name:"Good Friday"},{date:"2025-04-21",name:"Easter Monday"},{date:"2025-05-05",name:"Early May Bank Holiday"},{date:"2025-05-26",name:"Spring Bank Holiday"},{date:"2025-08-25",name:"Summer Bank Holiday"},{date:"2025-12-25",name:"Christmas Day"},{date:"2025-12-26",name:"Boxing Day"}]}},DE:{name:"Germany",holidays:{2024:[{date:"2024-01-01",name:"New Year's Day"},{date:"2024-03-29",name:"Good Friday"},{date:"2024-04-01",name:"Easter Monday"},{date:"2024-05-01",name:"Labour Day"},{date:"2024-05-09",name:"Ascension Day"},{date:"2024-05-20",name:"Whit Monday"},{date:"2024-10-03",name:"German Unity Day"},{date:"2024-12-25",name:"Christmas Day"},{date:"2024-12-26",name:"Boxing Day"}],2025:[{date:"2025-01-01",name:"New Year's Day"},{date:"2025-04-18",name:"Good Friday"},{date:"2025-04-21",name:"Easter Monday"},{date:"2025-05-01",name:"Labour Day"},{date:"2025-05-29",name:"Ascension Day"},{date:"2025-06-09",name:"Whit Monday"},{date:"2025-10-03",name:"German Unity Day"},{date:"2025-12-25",name:"Christmas Day"},{date:"2025-12-26",name:"Boxing Day"}]}}}}init(e){this.country=e}getHolidays(e){const t=this.holidayData[this.country];return!t||!t.holidays[e]?[]:t.holidays[e].map(n=>({...n,date:n.date+" 00:00:00"}))}}const L="modulepreload",b=function(l){return"/apps/event-countdown/"+l},p={},m=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let y=function(d){return Promise.all(d.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};var i=y;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),r=o?.nonce||o?.getAttribute("nonce");a=y(t.map(d=>{if(d=b(d),d in p)return;p[d]=!0;const c=d.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":L,c||(u.as="script"),u.crossOrigin="",u.href=d,r&&u.setAttribute("nonce",r),document.head.appendChild(u),c)return new Promise((f,E)=>{u.addEventListener("load",f),u.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=o,window.dispatchEvent(r),!r.defaultPrevented)throw o}return a.then(o=>{for(const r of o||[])r.status==="rejected"&&s(r.reason);return e().catch(s)})},I=(l,e,t)=>{const n=l[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};class H{DEFAULT_LANGUAGE="en";constructor(){this.translations={},this.language=this.DEFAULT_LANGUAGE,this.onLanguageChange=()=>{},this.supportedLanguageCodes=D.map(e=>e.code)}getInitialLanguage(){const e="/apps/event-countdown/",t=window.location.pathname,n=e.endsWith("/")?e:`${e}/`;if(t.startsWith(n)){const i=t.substring(n.length).split("/")[0];if(this.supportedLanguageCodes.includes(i))return i}const a=localStorage.getItem("language");if(this.supportedLanguageCodes.includes(a))return a;const s=navigator.language.split("-")[0];return this.supportedLanguageCodes.includes(s)?s:document.documentElement.lang||this.DEFAULT_LANGUAGE}async loadLanguage(e,t=!1){try{const n=await I(Object.assign({"./locales/de.json":()=>m(()=>import("./de-DjVwt7sL.js"),[]),"./locales/en.json":()=>m(()=>import("./en-BWWPvHQA.js"),[]),"./locales/es.json":()=>m(()=>import("./es-DqjIsj-o.js"),[]),"./locales/fr.json":()=>m(()=>import("./fr-DUexvFRx.js"),[]),"./locales/sv.json":()=>m(()=>import("./sv-hK1TUiKt.js"),[])}),`./locales/${e}.json`,3);if(this.translations=n.default,this.language=e,localStorage.setItem("language",e),!t){const a="/apps/event-countdown/",s=a.endsWith("/")?a:`${a}/`,i=e===this.DEFAULT_LANGUAGE?s:`${s}${e}/`;history.pushState({lang:e},"",i)}document.documentElement.lang=e,this.onLanguageChange()}catch(n){console.error(`Could not load language file for: ${e}`,n),e!==this.DEFAULT_LANGUAGE&&await this.loadLanguage(this.DEFAULT_LANGUAGE)}}translate(e,t={}){let n=this.translations[e]||e;for(const a in t)n=n.replace(`{${a}}`,t[a]);return n}getCurrentLanguage(){return this.language}}const g=new H;class A{constructor(){this.permission="default","Notification"in window&&(this.permission=Notification.permission)}isSupported(){return"Notification"in window}getPermission(){return this.permission}async requestPermission(){return this.isSupported()?(this.permission=await Notification.requestPermission(),this.permission):"unsupported"}showNotification(e,t){this.permission==="granted"&&new Notification(e,t)}}document.addEventListener("DOMContentLoaded",async()=>{const l=g.getInitialLanguage();await g.loadLanguage(l,!0);const e=new C,t=new A,n=new S(e);new w(n,g,t)});
